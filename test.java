this code modified by jdev2
